<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Carrinho – ANEW</title>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
<script src="firebase-config.js"></script>

<style>
body{margin:0;font-family:Arial,sans-serif;background:#F4EDE3;color:#3A2F2A;}
header{background:#E3C6BA;padding:16px 24px;display:flex;justify-content:center;}
header h1{margin:0;font-size:24px;}

.menu-icon{font-size:28px;cursor:pointer;position:fixed;top:18px;right:18px;z-index:1100;}
.sidebar{height:100%;width:0;position:fixed;top:0;right:0;background:#E3C6BA;overflow-x:hidden;transition:0.35s;padding-top:60px;z-index:1200;box-shadow:-3px 0 10px rgba(0,0,0,0.15);}
.sidebar a{padding:14px 24px;display:block;font-size:18px;color:#3A2F2A;text-decoration:none;}
.sidebar .closebtn{position:absolute;top:10px;right:20px;font-size:32px;}
.overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.45);z-index:1150;}

.container{max-width:900px;margin:40px auto;background:white;padding:24px;border-radius:12px;box-shadow:0 6px 16px rgba(0,0,0,0.06);}
.item{display:flex;justify-content:space-between;border-bottom:1px solid #eee;padding:14px 0;}
.item small{color:#6b5a54;}
.total{text-align:right;font-size:20px;font-weight:bold;margin-top:16px;}
button{margin-top:18px;padding:12px 20px;background:#C69A8D;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:bold;width:100%;}
button.remove{background:#b26b6b;width:auto;padding:6px 12px;font-size:13px;}

footer{background:#fff;padding:60px 20px;margin-top:60px;}
footer h4{margin-bottom:10px;}
footer a{display:block;margin:6px 0;color:#3A2F2A;text-decoration:none;}
footer a:hover{text-decoration:underline;}

</style>
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
/>
</head>

<body>
<header>
  <h1>ANEW</h1>
</header>

<div class="menu-icon" onclick="toggleMenu()">☰</div>
<div id="sidebar" class="sidebar">
  <a href="javascript:void(0)" class="closebtn" onclick="toggleMenu()">&times;</a>
  <a href="index.html">Início</a>
  <a href="products.html">Produtos</a>
  <a href="cart.html">Carrinho</a>
  <a href="profile.html">Perfil</a>
  <a href="#" onclick="logout()">Logout</a>
</div>
<div id="overlay" class="overlay" onclick="toggleMenu()"></div>

<div class="container">
  <h2>O teu Carrinho</h2>
  <div id="cartItems"></div>
  <div id="cartTotal" class="total">Total: €0.00</div>
  <button onclick="goCheckout()">Finalizar Compra</button>
</div>

<script>
// sidebar
function toggleMenu(){
  const s = document.getElementById('sidebar');
  const o = document.getElementById('overlay');
  if(s.style.width === '250px'){ s.style.width='0'; o.style.display='none'; }
  else { s.style.width='250px'; o.style.display='block'; }
}

// logout
function logout(){
  auth.signOut().then(()=> window.location='login.html');
}

// auth
let currentUser = null;
auth.onAuthStateChanged(user=>{
  currentUser=user;
  if(!user){ alert("Tens de fazer login."); window.location='login.html'; }
  else loadCart();
});

// load cart
function loadCart(){
  db.collection('carts').doc(currentUser.uid).get()
    .then(doc=>{
      const items = doc.exists?doc.data().items:[];
      renderCart(items);
    }).catch(err=>alert("Erro a carregar carrinho: "+err.message));
}

// render cart
function renderCart(items){
  const area = document.getElementById("cartItems");
  if(items.length===0){ area.innerHTML="<p>O carrinho está vazio.</p>"; document.getElementById("cartTotal").textContent="Total: €0.00"; return; }
  let html=""; let total=0;
  items.forEach((it,i)=>{
    total+=Number(it.price);
    html+=`<div class="item">
      <div><strong>${it.name}</strong><br><small>${it.size}, ${it.color}</small></div>
      <div>€${Number(it.price).toFixed(2)}<br><button class="remove" onclick="removeItem(${i})">X</button></div>
    </div>`;
  });
  area.innerHTML=html;
  document.getElementById("cartTotal").textContent="Total: €"+total.toFixed(2);
}

// remove item
function removeItem(index){
  db.collection('carts').doc(currentUser.uid).get()
    .then(doc=>{
      let items = doc.data().items || [];
      items.splice(index,1);
      return db.collection('carts').doc(currentUser.uid).set({items});
    }).then(()=>loadCart())
    .catch(err=>alert("Erro ao remover: "+err.message));
}

// checkout
function goCheckout(){ window.location="checkout.html"; }
</script>
<footer>
  <div style="max-width:1200px;margin:auto;display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:40px;">

    <div>
      <h4>OBTER AJUDA</h4>
      <a href="contact.html">Contacta-nos</a>
      <a href="faq.html">Perguntas Frequentes</a>
    </div>

    <div>
      <h4>ANEW</h4>
      <a href="about.html">Sobre nós</a>
    </div>

    <div>
      <h4>INFORMAÇÕES</h4>
      <a href="#">Privacidade</a>
      <a href="#">Termos</a>
    </div>

    <div>
      <h4>SEGUE-NOS</h4>
      <div style="display:flex;gap:18px;margin-top:12px;font-size:22px;">

  <a href="https://www.instagram.com/anew.pt"
     target="_blank"
     aria-label="Instagram"
     style="color:#3A2F2A;">
    <i class="fa-brands fa-instagram"></i>
  </a>

  <a href="https://www.tiktok.com/@anew.jap"
     target="_blank"
     aria-label="TikTok"
     style="color:#3A2F2A;">
    <i class="fa-brands fa-tiktok"></i>
  </a>

  <a href="https://www.facebook.com/anew.jap"
     target="_blank"
     aria-label="Facebook"
     style="color:#3A2F2A;">
    <i class="fa-brands fa-facebook-f"></i>
  </a>

      </div>
    </div>
  </div>

  <div style="text-align:center;margin-top:40px;font-size:14px;color:#666;">
    © 2026 ANEW — Para todas as formas de ser mulher.
  </div>
</footer>
</body>
</html>
